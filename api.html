<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø§Ø®ØªØ¨Ø§Ø± ChatGPT API â€“ Ø´Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠ</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  direction: rtl;
  padding: 20px;
}

h2 {
  margin-bottom: 10px;
}

input, textarea, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  font-size: 14px;
}

textarea {
  resize: vertical;
}

button {
  background: #0d6efd;
  color: white;
  border: none;
  cursor: pointer;
}

button:hover {
  background: #084298;
}

#chat {
  background: #ffffff;
  padding: 15px;
  height: 350px;
  overflow-y: auto;
  border: 1px solid #ccc;
  margin-top: 15px;
}

.user {
  color: #0a58ca;
  margin-bottom: 12px;
}

.assistant {
  color: #198754;
  margin-bottom: 12px;
}

.system {
  color: #6c757d;
  font-style: italic;
  margin-bottom: 12px;
}
</style>
</head>

<body>

<h2>ğŸ’¬ Ø§Ø®ØªØ¨Ø§Ø± ChatGPT API â€“ Ø´Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠ</h2>

<label>ğŸ”‘ OpenAI API Key</label>
<input type="password" id="apiKey" placeholder="sk-...">

<label>ğŸ§  SYSTEM PROMPT (ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù…Ø®ÙÙŠØ©)</label>
<textarea id="systemPrompt" rows="6"
placeholder="Ø­Ø· Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù‡Ù†Ø§..."></textarea>

<button onclick="startChat()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø´Ø§Øª</button>

<div id="chat"></div>

<label>âœï¸ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
<textarea id="userInput" rows="3"
placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§..."></textarea>

<button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>

<script>
let messages = [];

function startChat() {
  const systemPrompt = document.getElementById("systemPrompt").value;
  const chat = document.getElementById("chat");

  const welcomeMessage = `
Ø´ÙƒØ±Ù‹Ø§ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ù…ÙˆÙ‚Ø¹ Ø¬Ù„Ø³Ø©.

Ø£Ù†Ø§ Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø¹Ù„Ù‰ Ø¹Ù…Ù„ ØªÙ‚ÙŠÙŠÙ… Ù†ÙØ³ÙŠ Ù…Ø¨Ø¯Ø¦ÙŠØŒ Ø­ØªÙ‰ Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ø¹ØªÙ…Ø¯ ÙˆÙ…Ø±Ø®Øµ ÙˆÙ„Ø¯ÙŠÙ‡ Ø®Ø¨Ø±Ø© ÙˆØªØ¯Ø±ÙŠØ¨ ÙÙŠ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ù…Ø´ÙƒÙ„ØªÙƒ ØªØ­Ø¯ÙŠØ¯Ù‹Ø§ØŒ Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† Ø­Ø¬Ø² Ø¬Ù„Ø³Ø© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ† (Ø¹Ù† Ø¨ÙØ¹Ø¯) Ù…Ø¹ Ø£ÙØ¶Ù„ Ù…Ø¹Ø§Ù„Ø¬ Ù…Ù…ÙƒÙ†ØŒ ÙˆØ¨Ø£ÙØ¶Ù„ Ø³Ø¹Ø±ØŒ ÙˆØ¨Ø³Ø±ÙŠØ© ØªØ§Ù…Ø©.

Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ØŸ
`;

  messages = [
    { role: "system", content: systemPrompt },
    { role: "assistant", content: welcomeMessage }
  ];

  chat.innerHTML = "";
  addToChat("assistant", welcomeMessage);
}

async function sendMessage() {
  const apiKey = document.getElementById("apiKey").value;
  const userText = document.getElementById("userInput").value;
  if (!userText) return;

  messages.push({ role: "user", content: userText });
  addToChat("user", userText);
  document.getElementById("userInput").value = "";

  try {
    const res = await fetch("https://api.openai.com/v1/chat/completions", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": "Bearer " + apiKey
      },
      body: JSON.stringify({
        model: "gpt-4.1-mini",
        messages: messages,
        temperature: 0.4
      })
    });

    const data = await res.json();

    if (data.error) {
      addToChat("assistant", "âŒ " + data.error.message);
      return;
    }

    const reply = data.choices[0].message.content;
    messages.push({ role: "assistant", content: reply });
    addToChat("assistant", reply);

  } catch (e) {
    addToChat("assistant", "âŒ Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„");
  }
}

function addToChat(role, text) {
  const chat = document.getElementById("chat");
  const div = document.createElement("div");
  div.className = role;

  if (role === "user") {
    div.textContent = "ğŸ§‘â€âš•ï¸ Ø£Ù†Øª: " + text;
  } else if (role === "assistant") {
    div.textContent = "ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯: " + text;
  } else {
    div.textContent = text;
  }

  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}
</script>

</body>
</html>
