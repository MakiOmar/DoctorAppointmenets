import{_ as E,u as I,m as P,n as U,f,g as C,z as q,c as a,a as e,F as T,s as A,t as i,d as y,q as d,A as D,o as l,x as k}from"./index-8434c12c.js";const K={name:"Appointments",setup(){const r=I(),n=P(),{t:x}=U(),o=f(!0),v=f(!1),h=f(!1),s=f([]),m=f("upcoming"),c=f(null),b=C(()=>[{id:"upcoming",name:x("appointments.tabs.upcoming"),count:s.value.filter(t=>t.status==="confirmed"||t.status==="pending").length},{id:"past",name:x("appointments.tabs.past"),count:s.value.filter(t=>t.status==="completed").length},{id:"cancelled",name:x("appointments.tabs.cancelled"),count:s.value.filter(t=>t.status==="cancelled").length}]),w=C(()=>{switch(m.value){case"upcoming":return s.value.filter(t=>t.status==="confirmed"||t.status==="pending");case"past":return s.value.filter(t=>t.status==="completed");case"cancelled":return s.value.filter(t=>t.status==="cancelled");default:return s.value}}),u=async()=>{o.value=!0;try{const t=await D.get("/api/ai/appointments");s.value=t.data.data||[]}catch(t){n.error("Failed to load appointments"),console.error("Error loading appointments:",t)}finally{o.value=!1}},M=t=>t?new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",S=t=>{if(!t)return"N/A";const[p,_]=t.split(":"),g=parseInt(p),L=g>=12?"PM":"AM";return`${g%12||12}:${_} ${L}`},$=t=>({pending:"Pending",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled",no_show:"No Show"})[t]||t,j=t=>`px-2 py-1 rounded-full text-xs font-medium ${{pending:"text-yellow-600 bg-yellow-100",confirmed:"text-green-600 bg-green-100",completed:"text-blue-600 bg-blue-100",cancelled:"text-red-600 bg-red-100",no_show:"text-gray-600 bg-gray-100"}[t]||""}`,V=t=>{if(t.status!=="confirmed")return!1;const g=new Date(`${t.date}T${t.time}`)-new Date;return g>=-5*60*1e3&&g<=15*60*1e3},z=t=>t.status!=="confirmed"&&t.status!=="pending"?!1:new Date(`${t.date}T${t.time}`)-new Date>24*60*60*1e3,N=t=>t.status!=="confirmed"&&t.status!=="pending"?!1:new Date(`${t.date}T${t.time}`)-new Date>24*60*60*1e3,B=t=>{n.info("Redirecting to session...")},H=t=>{r.push(`/booking/reschedule/${t}`)},R=t=>{c.value=t,h.value=!0},F=async()=>{if(c.value){v.value=!0;try{await D.put(`/api/ai/appointments/${c.value}/cancel`),n.success("Appointment cancelled successfully"),await u(),h.value=!1,c.value=null}catch(t){n.error("Failed to cancel appointment"),console.error("Error cancelling appointment:",t)}finally{v.value=!1}}},J=t=>{r.push(`/appointments/${t}`)};return q(()=>{u()}),{loading:o,cancelling:v,showCancelModal:h,appointments:s,activeTab:m,tabs:b,filteredAppointments:w,formatDate:M,formatTime:S,getStatusText:$,getStatusClass:j,canJoinSession:V,canReschedule:z,canCancel:N,joinSession:B,rescheduleAppointment:H,cancelAppointment:R,confirmCancel:F,viewAppointmentDetails:J}}},G={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},O={class:"mb-8"},Q={class:"border-b border-gray-200"},W={class:"-mb-px flex space-x-8"},X=["onClick"],Y={key:0,class:"text-center py-12"},Z={key:1,class:"space-y-6"},tt={class:"md:flex md:items-center md:justify-between"},et={class:"md:flex md:items-center md:space-x-6"},st=["src","alt"],nt={class:"flex-1"},ot={class:"text-lg font-semibold text-gray-900 mb-2"},at={class:"grid md:grid-cols-2 gap-4 text-sm text-gray-600"},lt={key:0,class:"mt-3"},it={class:"text-gray-600 text-sm mt-1"},rt={class:"mt-4 md:mt-0 md:ml-6 flex flex-col space-y-2"},ct=["onClick"],dt=["onClick"],mt=["onClick"],ut=["onClick"],pt={key:0,class:"mt-4 p-3 bg-blue-50 rounded-lg"},ft={class:"flex items-center justify-between"},gt=["href"],yt={key:2,class:"text-center py-12"},xt={class:"text-lg font-medium text-gray-900 mb-2"},vt={class:"text-gray-600 mb-6"},ht={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},bt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},wt={class:"mt-3 text-center"},_t={class:"text-lg font-medium text-gray-900 mb-4"},kt={class:"text-sm text-gray-600 mb-6"},Ct={class:"flex justify-center space-x-4"},Tt=["disabled"],At={key:0,class:"flex items-center"},Dt={key:1};function Mt(r,n,x,o,v,h){return l(),a("div",null,[e("div",G,[n[11]||(n[11]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"My Appointments",-1)),e("div",O,[e("div",Q,[e("nav",W,[(l(!0),a(T,null,A(o.tabs,s=>(l(),a("button",{key:s.id,onClick:m=>o.activeTab=s.id,class:k([o.activeTab===s.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])},[y(i(s.name)+" ",1),s.count!==void 0?(l(),a("span",{key:0,class:k([o.activeTab===s.id?"bg-primary-100 text-primary-600":"bg-gray-100 text-gray-900","ml-2 py-0.5 px-2.5 rounded-full text-xs font-medium"])},i(s.count),3)):d("",!0)],10,X))),128))])])]),o.loading?(l(),a("div",Y,n[3]||(n[3]=[e("svg",{class:"animate-spin h-12 w-12 text-primary-600 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"text-gray-600"},"Loading appointments...",-1)]))):o.filteredAppointments.length>0?(l(),a("div",Z,[(l(!0),a(T,null,A(o.filteredAppointments,s=>{var m,c,b,w;return l(),a("div",{key:s.id,class:"card"},[e("div",tt,[e("div",et,[e("img",{src:((m=s.therapist)==null?void 0:m.photo)||"/default-therapist.svg",alt:(c=s.therapist)==null?void 0:c.name,class:k(["w-16 h-16 rounded-full mb-4 md:mb-0",(b=s.therapist)!=null&&b.photo?"object-cover":"object-contain bg-gray-100 p-1"])},null,10,st),e("div",nt,[e("h3",ot,i((w=s.therapist)==null?void 0:w.name),1),e("div",at,[e("div",null,[n[4]||(n[4]=e("span",{class:"font-medium"},"Date:",-1)),y(" "+i(o.formatDate(s.date)),1)]),e("div",null,[n[5]||(n[5]=e("span",{class:"font-medium"},"Time:",-1)),y(" "+i(o.formatTime(s.time)),1)]),e("div",null,[n[6]||(n[6]=e("span",{class:"font-medium"},"Duration:",-1)),y(" "+i(s.session_type)+" minutes ",1)]),e("div",null,[n[7]||(n[7]=e("span",{class:"font-medium"},"Status:",-1)),e("span",{class:k(o.getStatusClass(s.status))},i(o.getStatusText(s.status)),3)])]),s.notes?(l(),a("div",lt,[n[8]||(n[8]=e("span",{class:"font-medium text-gray-900"},"Notes:",-1)),e("p",it,i(s.notes),1)])):d("",!0)])]),e("div",rt,[o.canJoinSession(s)?(l(),a("button",{key:0,onClick:u=>o.joinSession(s.id),class:"btn-primary text-sm"}," Join Session ",8,ct)):d("",!0),o.canReschedule(s)?(l(),a("button",{key:1,onClick:u=>o.rescheduleAppointment(s.id),class:"btn-outline text-sm"}," Reschedule ",8,dt)):d("",!0),o.canCancel(s)?(l(),a("button",{key:2,onClick:u=>o.cancelAppointment(s.id),class:"btn-outline text-sm text-red-600 hover:text-red-700"}," Cancel ",8,mt)):d("",!0),e("button",{onClick:u=>o.viewAppointmentDetails(s.id),class:"btn-outline text-sm"}," View Details ",8,ut)])]),s.session_link?(l(),a("div",pt,[e("div",ft,[n[9]||(n[9]=e("div",null,[e("p",{class:"text-sm font-medium text-blue-900"},"Session Link Available"),e("p",{class:"text-xs text-blue-700"},"Click the link below to join your session")],-1)),e("a",{href:s.session_link,target:"_blank",class:"btn-primary text-sm"}," Join Now ",8,gt)])])):d("",!0)])}),128))])):(l(),a("div",yt,[n[10]||(n[10]=e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("h3",xt,i(r.$t("appointments.noAppointments")),1),e("p",vt,i(o.activeTab==="upcoming"?r.$t("appointments.noUpcoming"):o.activeTab==="past"?r.$t("appointments.noPast"):r.$t("appointments.noCancelled")),1),e("button",{onClick:n[0]||(n[0]=s=>r.$router.push("/therapists")),class:"btn-primary"},i(r.$t("appointments.bookSession")),1)]))]),o.showCancelModal?(l(),a("div",ht,[e("div",bt,[e("div",wt,[e("h3",_t,i(r.$t("appointments.cancelTitle")),1),e("p",kt,i(r.$t("appointments.cancelMessage")),1),e("div",Ct,[e("button",{onClick:n[1]||(n[1]=(...s)=>o.confirmCancel&&o.confirmCancel(...s)),disabled:o.cancelling,class:"btn-primary"},[o.cancelling?(l(),a("span",At,[n[12]||(n[12]=e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),y(" "+i(r.$t("appointments.cancelling")),1)])):(l(),a("span",Dt,i(r.$t("appointments.yesCancel")),1))],8,Tt),e("button",{onClick:n[2]||(n[2]=s=>o.showCancelModal=!1),class:"btn-outline"},i(r.$t("appointments.noKeep")),1)])])])])):d("",!0)])}const jt=E(K,[["render",Mt]]);export{jt as default};
