import{_ as Y,u as E,m as P,f as m,g as C,y as I,c as a,a as e,F as T,q as A,t as r,d as x,p as d,z as D,o as l,s as _}from"./index-7da7b438.js";const U={name:"Appointments",setup(){const y=E(),s=P(),v=m(!0),o=m(!1),h=m(!1),i=m([]),n=m("upcoming"),c=m(null),b=C(()=>[{id:"upcoming",name:"Upcoming",count:i.value.filter(t=>t.status==="confirmed"||t.status==="pending").length},{id:"past",name:"Past",count:i.value.filter(t=>t.status==="completed").length},{id:"cancelled",name:"Cancelled",count:i.value.filter(t=>t.status==="cancelled").length}]),w=C(()=>{switch(n.value){case"upcoming":return i.value.filter(t=>t.status==="confirmed"||t.status==="pending");case"past":return i.value.filter(t=>t.status==="completed");case"cancelled":return i.value.filter(t=>t.status==="cancelled");default:return i.value}}),p=async()=>{v.value=!0;try{const t=await D.get("/api/ai/appointments");i.value=t.data.data||[]}catch(t){s.error("Failed to load appointments"),console.error("Error loading appointments:",t)}finally{v.value=!1}},f=t=>t?new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"N/A",M=t=>{if(!t)return"N/A";const[u,k]=t.split(":"),g=parseInt(u),L=g>=12?"PM":"AM";return`${g%12||12}:${k} ${L}`},S=t=>({pending:"Pending",confirmed:"Confirmed",completed:"Completed",cancelled:"Cancelled",no_show:"No Show"})[t]||t,N=t=>`px-2 py-1 rounded-full text-xs font-medium ${{pending:"text-yellow-600 bg-yellow-100",confirmed:"text-green-600 bg-green-100",completed:"text-blue-600 bg-blue-100",cancelled:"text-red-600 bg-red-100",no_show:"text-gray-600 bg-gray-100"}[t]||""}`,j=t=>{if(t.status!=="confirmed")return!1;const g=new Date(`${t.date}T${t.time}`)-new Date;return g>=-5*60*1e3&&g<=15*60*1e3},V=t=>t.status!=="confirmed"&&t.status!=="pending"?!1:new Date(`${t.date}T${t.time}`)-new Date>24*60*60*1e3,z=t=>t.status!=="confirmed"&&t.status!=="pending"?!1:new Date(`${t.date}T${t.time}`)-new Date>24*60*60*1e3,B=t=>{s.info("Redirecting to session...")},H=t=>{y.push(`/booking/reschedule/${t}`)},R=t=>{c.value=t,h.value=!0},F=async()=>{if(c.value){o.value=!0;try{await D.put(`/api/ai/appointments/${c.value}/cancel`),s.success("Appointment cancelled successfully"),await p(),h.value=!1,c.value=null}catch(t){s.error("Failed to cancel appointment"),console.error("Error cancelling appointment:",t)}finally{o.value=!1}}},J=t=>{y.push(`/appointments/${t}`)};return I(()=>{p()}),{loading:v,cancelling:o,showCancelModal:h,appointments:i,activeTab:n,tabs:b,filteredAppointments:w,formatDate:f,formatTime:M,getStatusText:S,getStatusClass:N,canJoinSession:j,canReschedule:V,canCancel:z,joinSession:B,rescheduleAppointment:H,cancelAppointment:R,confirmCancel:F,viewAppointmentDetails:J}}},q={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K={class:"mb-8"},G={class:"border-b border-gray-200"},O={class:"-mb-px flex space-x-8"},Q=["onClick"],W={key:0,class:"text-center py-12"},X={key:1,class:"space-y-6"},Z={class:"md:flex md:items-center md:justify-between"},$={class:"md:flex md:items-center md:space-x-6"},tt=["src","alt"],et={class:"flex-1"},st={class:"text-lg font-semibold text-gray-900 mb-2"},nt={class:"grid md:grid-cols-2 gap-4 text-sm text-gray-600"},ot={key:0,class:"mt-3"},at={class:"text-gray-600 text-sm mt-1"},lt={class:"mt-4 md:mt-0 md:ml-6 flex flex-col space-y-2"},it=["onClick"],rt=["onClick"],ct=["onClick"],dt=["onClick"],ut={key:0,class:"mt-4 p-3 bg-blue-50 rounded-lg"},mt={class:"flex items-center justify-between"},pt=["href"],ft={key:2,class:"text-center py-12"},gt={class:"text-gray-600 mb-6"},xt={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},yt={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},vt={class:"mt-3 text-center"},ht={class:"flex justify-center space-x-4"},bt=["disabled"],wt={key:0,class:"flex items-center"},kt={key:1};function _t(y,s,v,o,h,i){return l(),a("div",null,[e("div",q,[s[12]||(s[12]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"My Appointments",-1)),e("div",K,[e("div",G,[e("nav",O,[(l(!0),a(T,null,A(o.tabs,n=>(l(),a("button",{key:n.id,onClick:c=>o.activeTab=n.id,class:_([o.activeTab===n.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm"])},[x(r(n.name)+" ",1),n.count!==void 0?(l(),a("span",{key:0,class:_([o.activeTab===n.id?"bg-primary-100 text-primary-600":"bg-gray-100 text-gray-900","ml-2 py-0.5 px-2.5 rounded-full text-xs font-medium"])},r(n.count),3)):d("",!0)],10,Q))),128))])])]),o.loading?(l(),a("div",W,s[3]||(s[3]=[e("svg",{class:"animate-spin h-12 w-12 text-primary-600 mx-auto mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),e("p",{class:"text-gray-600"},"Loading appointments...",-1)]))):o.filteredAppointments.length>0?(l(),a("div",X,[(l(!0),a(T,null,A(o.filteredAppointments,n=>{var c,b,w,p;return l(),a("div",{key:n.id,class:"card"},[e("div",Z,[e("div",$,[e("img",{src:((c=n.therapist)==null?void 0:c.photo)||"/default-therapist.svg",alt:(b=n.therapist)==null?void 0:b.name,class:_(["w-16 h-16 rounded-full mb-4 md:mb-0",(w=n.therapist)!=null&&w.photo?"object-cover":"object-contain bg-gray-100 p-1"])},null,10,tt),e("div",et,[e("h3",st,r((p=n.therapist)==null?void 0:p.name),1),e("div",nt,[e("div",null,[s[4]||(s[4]=e("span",{class:"font-medium"},"Date:",-1)),x(" "+r(o.formatDate(n.date)),1)]),e("div",null,[s[5]||(s[5]=e("span",{class:"font-medium"},"Time:",-1)),x(" "+r(o.formatTime(n.time)),1)]),e("div",null,[s[6]||(s[6]=e("span",{class:"font-medium"},"Duration:",-1)),x(" "+r(n.session_type)+" minutes ",1)]),e("div",null,[s[7]||(s[7]=e("span",{class:"font-medium"},"Status:",-1)),e("span",{class:_(o.getStatusClass(n.status))},r(o.getStatusText(n.status)),3)])]),n.notes?(l(),a("div",ot,[s[8]||(s[8]=e("span",{class:"font-medium text-gray-900"},"Notes:",-1)),e("p",at,r(n.notes),1)])):d("",!0)])]),e("div",lt,[o.canJoinSession(n)?(l(),a("button",{key:0,onClick:f=>o.joinSession(n.id),class:"btn-primary text-sm"}," Join Session ",8,it)):d("",!0),o.canReschedule(n)?(l(),a("button",{key:1,onClick:f=>o.rescheduleAppointment(n.id),class:"btn-outline text-sm"}," Reschedule ",8,rt)):d("",!0),o.canCancel(n)?(l(),a("button",{key:2,onClick:f=>o.cancelAppointment(n.id),class:"btn-outline text-sm text-red-600 hover:text-red-700"}," Cancel ",8,ct)):d("",!0),e("button",{onClick:f=>o.viewAppointmentDetails(n.id),class:"btn-outline text-sm"}," View Details ",8,dt)])]),n.session_link?(l(),a("div",ut,[e("div",mt,[s[9]||(s[9]=e("div",null,[e("p",{class:"text-sm font-medium text-blue-900"},"Session Link Available"),e("p",{class:"text-xs text-blue-700"},"Click the link below to join your session")],-1)),e("a",{href:n.session_link,target:"_blank",class:"btn-primary text-sm"}," Join Now ",8,pt)])])):d("",!0)])}),128))])):(l(),a("div",ft,[s[10]||(s[10]=e("svg",{class:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),s[11]||(s[11]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"No appointments found",-1)),e("p",gt,r(o.activeTab==="upcoming"?"You don't have any upcoming appointments.":o.activeTab==="past"?"You don't have any past appointments.":"You don't have any cancelled appointments."),1),e("button",{onClick:s[0]||(s[0]=n=>y.$router.push("/therapists")),class:"btn-primary"}," Book a Session ")]))]),o.showCancelModal?(l(),a("div",xt,[e("div",yt,[e("div",vt,[s[14]||(s[14]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Cancel Appointment",-1)),s[15]||(s[15]=e("p",{class:"text-sm text-gray-600 mb-6"}," Are you sure you want to cancel this appointment? This action cannot be undone. ",-1)),e("div",ht,[e("button",{onClick:s[1]||(s[1]=(...n)=>o.confirmCancel&&o.confirmCancel(...n)),disabled:o.cancelling,class:"btn-primary"},[o.cancelling?(l(),a("span",wt,s[13]||(s[13]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),x(" Cancelling... ")]))):(l(),a("span",kt,"Yes, Cancel"))],8,bt),e("button",{onClick:s[2]||(s[2]=n=>o.showCancelModal=!1),class:"btn-outline"}," No, Keep ")])])])])):d("",!0)])}const At=Y(U,[["render",_t]]);export{At as default};
